{"version":3,"file":"RegExpForm.js","sourceRoot":"","sources":["../../../../src/components/Configurator/RegExpForm/RegExpForm.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Grid, TextFieldProps } from '@mui/material';\nimport { useCallback, useEffect, useState } from 'react';\nimport { getValues, someAreTruthy, stringToRegex } from '../../../utils';\nimport {\n  getDefaultInteactiveSimpleListItem,\n  InteactiveSimpleList,\n  SimpleCheckbox,\n  SimpleTextField,\n  Vertical,\n} from 'mui';\nimport { noop, values } from 'lodash/fp';\nimport React from 'react';\nimport { RegExpMarkerOptions } from 'mark.js';\n\nexport type RegExpFormRawValues = {\n  element: string;\n  ignoreGroups: number;\n  className: string;\n  iframesTimeout: number;\n  acrossElements: boolean;\n  iframes: boolean;\n  debug: boolean;\n  exclude: TextFieldProps[];\n};\n\nconst defaultConfig: RegExpMarkerOptions = {\n  acrossElements: false,\n  className: '',\n  debug: false,\n  done: () => {},\n  each: () => {},\n  element: 'mark',\n  exclude: [],\n  filter: () => {},\n  iframes: false,\n  iframesTimeout: 5000,\n  ignoreGroups: 0,\n  log: console,\n  noMatch: () => {},\n};\n\nconst getRefinedOptions = (\n  options: RegExpFormRawValues\n): RegExpMarkerOptions => {\n  const {\n    acrossElements,\n    className,\n    debug,\n    element,\n    exclude,\n    iframes,\n    iframesTimeout,\n    ignoreGroups,\n  } = options;\n  const excludeValue = getValues<TextFieldProps, unknown>(exclude);\n  return {\n    acrossElements:\n      acrossElements === defaultConfig.acrossElements\n        ? undefined\n        : acrossElements,\n    className: className === defaultConfig.className ? undefined : className,\n    debug: debug === defaultConfig.debug ? undefined : debug,\n    done: undefined,\n    each: undefined,\n    element: element === defaultConfig.element ? undefined : element,\n    exclude: excludeValue.length > 0 ? excludeValue : undefined,\n    filter: undefined,\n    iframes: iframes === defaultConfig.iframes ? undefined : iframes,\n    iframesTimeout:\n      iframesTimeout === defaultConfig.iframesTimeout\n        ? undefined\n        : Number(iframesTimeout),\n    ignoreGroups:\n      defaultConfig.ignoreGroups === ignoreGroups\n        ? undefined\n        : Number(ignoreGroups),\n    log: undefined,\n    noMatch: undefined,\n  };\n};\n\nexport type RegExpChangeHandler = (regExpValue: RegExp) => void;\n\nexport type RegExpFormProps = {\n  onChangeRegExp?: RegExpChangeHandler;\n  onChangeOptions?: (regExpConfig: RegExpMarkerOptions | undefined) => void;\n};\n\nexport const RegExpForm = ({\n  onChangeOptions = noop,\n  onChangeRegExp = noop,\n}: RegExpFormProps) => {\n  const [regexp, setRegexp] = useState<string>('/Lorem/');\n\n  const [options, setOptions] = useState<RegExpFormRawValues>({\n    acrossElements: false,\n    className: '',\n    debug: false,\n    element: 'mark',\n    exclude: [getDefaultInteactiveSimpleListItem()],\n    iframes: false,\n    iframesTimeout: 5000,\n    ignoreGroups: 0,\n  });\n\n  const handleChange = useCallback((key: string, value: any) => {\n    switch (key) {\n      case 'regexp':\n        setRegexp(value);\n        break;\n      default:\n        setOptions((prevState) => ({\n          ...prevState,\n          [key]: value,\n        }));\n    }\n  }, []);\n\n  useEffect(() => {\n    onChangeRegExp(stringToRegex(regexp));\n  }, [onChangeRegExp, regexp]);\n\n  useEffect(() => {\n    const refinedOptions = getRefinedOptions(options);\n    const refinedOptionValues = values(refinedOptions);\n    const someHaveDefinedValues = someAreTruthy(refinedOptionValues);\n\n    onChangeOptions(someHaveDefinedValues ? refinedOptions : undefined);\n  }, [onChangeOptions, options]);\n\n  return (\n    <Grid container spacing={2}>\n      <Grid item xs={6}>\n        <Vertical gap={2}>\n          <SimpleTextField\n            fullWidth\n            label=\"RegExp\"\n            name=\"regexp\"\n            value={regexp}\n            size=\"small\"\n            onChange={handleChange}\n          />\n          <SimpleTextField\n            fullWidth\n            label=\"Element\"\n            name=\"element\"\n            value={options.element}\n            size=\"small\"\n            onChange={handleChange}\n          />\n          <InteactiveSimpleList\n            title=\"Exclude\"\n            label=\"exclude\"\n            value={options.exclude}\n            name=\"exclude\"\n            onChange={handleChange}\n          />\n          <SimpleTextField\n            fullWidth\n            type=\"number\"\n            label=\"IFrames Timeout\"\n            name=\"iframesTimeout\"\n            value={options.iframesTimeout}\n            size=\"small\"\n            onChange={handleChange}\n          />\n        </Vertical>\n      </Grid>\n      <Grid item xs={6}>\n        <Vertical gap={2}>\n          <SimpleTextField\n            fullWidth\n            label=\"Class Name\"\n            name=\"className\"\n            value={options.className}\n            size=\"small\"\n            onChange={handleChange}\n          />\n          <SimpleTextField\n            fullWidth\n            type=\"number\"\n            label=\"Ignore Groups\"\n            name=\"ignoreGroups\"\n            value={options.ignoreGroups}\n            size=\"small\"\n            onChange={handleChange}\n          />\n          <Vertical>\n            <SimpleCheckbox\n              label=\"Across Elements\"\n              name=\"acrossElements\"\n              value={options.acrossElements}\n              onChange={handleChange}\n            />\n            <SimpleCheckbox\n              label=\"IFrames\"\n              name=\"iframes\"\n              value={options.iframes}\n              onChange={handleChange}\n            />\n            <SimpleCheckbox\n              label=\"Debug\"\n              name=\"debug\"\n              value={options.debug}\n              onChange={handleChange}\n            />\n          </Vertical>\n        </Vertical>\n      </Grid>\n    </Grid>\n  );\n};\n"]}